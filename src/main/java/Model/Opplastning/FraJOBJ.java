
package Model.Opplastning;

//import Model.Lagring.TilJOBJ;
import Model.Avvik.InvalidJavaObjectFormatException;
import Model.Domene.Artist;
import Model.Registrering.Register;
import java.io.EOFException;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.util.ArrayList;
import java.util.List;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;




public class FraJOBJ extends OpplastingSystem {
    
   // Register register=Register.getInstance();
    
    private File file;
    private Register register=Register.getInstance();
    
    
    public FraJOBJ(File file){
        super(file);
    }
    
    public boolean sjekkDuplikat(Object obj, String valgt){
         ArrayList<Artist> test=null;
        switch(valgt){
                case "Artist":
                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                 test=register.getArtister();
                 Artist artistToCheck=(Artist)obj;
                
                 for(Artist artist : test){
                     System.out.println(artist+" mot"+artistToCheck);
                     if(artistToCheck.equals(artist)){
                         System.err.print("Match");
                         return true;
                     }
                     else{
                         System.out.println("Ikke match");
                        return false;
                     }
                 }
              
                    // break;
                  
                case "Lokale":
                  
                      break;
            
                case "Arrangement":
           
                    break;
            
                 case "KontaktPerson":
                    
                     break;
            
                    case "Billett":
              
                         break;
            }
        return false;
    }
    
    public void registrerFraFil(ObservableList<Object> objekter, String valgt){
         for (Object obj : objekter){
                if(!sjekkDuplikat(obj, valgt)){
                       register.registrer(obj);
                }
               
         
              }
    }
   
   
    public ObservableList<Object> ReadObjectsFromFile(String filepath) throws ClassNotFoundException, EOFException, IOException, InvalidJavaObjectFormatException  {
     
        try {
            
            FileInputStream fileIn = new FileInputStream(filepath);
            ObjectInputStream objectIn = new ObjectInputStream(fileIn);
            List<Object> objekter=(List<Object>)objectIn.readObject();
         //  objekter=(ObservableList<Lokale>)objectIn.readObject();
       
       ObservableList<Object> liste=FXCollections.observableArrayList(objekter);
       if (liste.get(0)==null){
           throw new InvalidJavaObjectFormatException("Ugydlig javaobject fil");
       }
      return liste;
        }
        catch(EOFException e){
            System.err.println(e.getMessage());
        }
 catch (IOException e){
         System.err.println(e.getMessage());
   }
        catch(ClassCastException e){
            System.err.println(e.getMessage());
        }
      
//      ObservableList<Object> liste=FXCollections.observableArrayList(objekter);
//return liste;
      return null;
    }
    
   }
        
    
